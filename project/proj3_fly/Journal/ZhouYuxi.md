# 实验三日志



### 4/21

#### 1、动力学模型

$$
m\ddot{x} = -(u_1+u_2)sin(\theta)
$$

$$
m\ddot{y} = (u_1+u_2)cos(\theta)-mg
$$

$$
I\ddot{\theta} = r(u_1 - u_2)
$$

通过简单变形我们得到：
$$
\theta = -arctan\frac{\ddot{x}}{\ddot{y}+g} --------------(1)
$$

$$
\ddot{\theta}=\frac{r(u_1-u_2)}{I}
$$

$$
\ddot{\theta}=\frac{m^2}{(u_1+u_2)^2}[x^{(2)}y^{(4)}-x^{(4)}(y^{(2)}+g)]=\frac{r(u_1-u_2)}{I}
$$

$$
x^{(2)}y^{(4)}-x^{(4)}(y^{(2)}+g)=\frac{r(u_1-u_2)(u_1+u_2)^2}{Im^2}----(2)
$$

$$
(\ddot{x})^2+(\ddot{y})^2 = \frac{(u_1+u_2)^2}{m^2}--------------(3)
$$



#### 2、初步分析

​		虽然这是一个欠驱动问题，输入一组驱动力我们不能得到唯一确定的一个加速度状态。但是从动力学模型中发现，如果我们能给定一条轨迹[x(t),y(t)],就能求出飞机的仰角和驱动力[u_1, u_2]。

只要这条轨迹需要满足以下要求

1、x(t),y(t)四阶可导，且四阶导数不能恒为0。

实际条件考虑：

2、轨迹要躲避障碍物。

3、因驱动力u_1 u_2有限, 由(2)(3)式对x(t)，y(t)做出约束。

4、飞机在飞行过程中仰角不能随意(特别是过黄色障碍物时)，由(1)式对轨迹作出约束。

#### 3、具体尝试

​		通过上面分析，路径规划的任务就比较明朗了，就是设计符合上述要求的轨迹x(t),y(t)。然后再进行路径优化，在这基础上尽量缩小时间。

##### 随便想想一：样条插值

(1)先在地图中进行三次样条插值得到一条轨迹:

$$
y = A_3x^3+A_2x^2+A_1x+A_0
$$
​								条件2(躲避障碍物)达成

(2)取x(t)为四次多项式:
$$
x(t)=B_4t^4+B_3t^3+B_2t^2+B_1t+B_0
$$
​								条件1(四次可导)达成

(3)反求出仰角和驱动力(烦)

(4)调整各五个系数B满足其他条件（烦）

优点：轨迹天然能够躲避障碍物

缺点：运算复杂(手算不可能)。



##### 随便想想二：直接参数方程

（1）设
$$
x(t)=A_4t^4+A_3t^4+A_2t^2+A_1t+A_0
$$

$$
y(t)=B_4t^4+B_3t^3+B_2t^2+B_1t+B_0
$$

​					条件一（四阶可导）达成

(2)反求仰角和驱动力

(3)设置合适参数使满足条件（烦）



可能运算稍微简单一点,但是要躲避障碍物比较复杂



### 4/23

我们组负责编写路径规划的函数GlobalTraj(),就是解决一个非线性规划问题。

#### 一、建立数学模型

状态量有6个：
$$
\underline{x_{state}}(t)=[x,y,\theta,\dot{x},\dot{y},\dot{\theta}]
$$
控制量：
$$
\underline{u}(t)=[u_1,u_2]
$$


##### (1)动力学模型离散化

我们规定N为步数，T为步长，那么花费总时间就是NT。
$$
\dot{x}(t_{k+1})=\dot{x}(t_{k})+\frac{T}{2m}\{[u_1(t_{k+1})+u_2(t_{k+1})]sin(\theta(t_{k+1}))+[u_1(t_{k})+u_2(t_{k})]sin(\theta(t_{k}))\}
$$

$$
\dot{y}(t_{k+1})=\dot{y}(t_{k})+\frac{T}{2m}\{[u_1(t_{k+1})+u_2(t_{k+1})]cos(\theta(t_{k+1}))+[u_1(t_{k})+u_2(t_{k})]cos(\theta(t_{k}))+2g\}
$$

$$
\dot{\theta}(t_{k+1})=\dot{\theta}(t_{k})+\frac{Tb}{2I_{yy}}\{[u_2(t_{k+1})-u_1(t_{k+1})]+[u_2(t_{k})-u_1(t_{k})]\}
$$

##### (2)初始条件和终点状态：

$$
\underline{x}(0)=[-16,0,0,0,0,0]
$$

$$
\underline{x}(NT)=[14,0,0,0,0,0]
$$

##### (3)约束

几何约束（比较复杂）

驱动力约束：
$$
-100\leq{u_1,u_2}\leq100
$$

##### (4)优化目标

$$
min(N)
$$

#### 二、学习优化工具包pyomo

https://pyomo.readthedocs.io/en/stable/pyomo_modeling_components/Parameters.html
